[gd_scene load_steps=23 format=3 uid="uid://cvlfxg610affe"]

[ext_resource type="PackedScene" uid="uid://clc830lkjlhip" path="res://scenes/map.tscn" id="1_5opw3"]
[ext_resource type="Script" uid="uid://65fhx2ltcthw" path="res://scenes/playerAssigner.cs" id="1_08o8g"]
[ext_resource type="PackedScene" uid="uid://b7hxl7dg26i7j" path="res://scenes/player.tscn" id="2_25dfr"]
[ext_resource type="AudioStream" uid="uid://dsw7n1rj7h8v6" path="res://Audio/dsfsf.mp3" id="3_2phbr"]
[ext_resource type="PackedScene" uid="uid://dpdvumg63k3xu" path="res://scenes/TownPanel.tscn" id="3_y7ipx"]
[ext_resource type="PackedScene" uid="uid://dao5worh1gb0c" path="res://scenes/TradeUI.tscn" id="4_5hv5t"]
[ext_resource type="AudioStream" uid="uid://dojjif4v2wcke" path="res://Audio/gtyg.mp3" id="4_mkg2b"]
[ext_resource type="AudioStream" uid="uid://ccu7ddjj2sqx4" path="res://Audio/gygy.mp3" id="5_1ns3k"]
[ext_resource type="PackedScene" uid="uid://durnjyano0ic4" path="res://scenes/waypoints.tscn" id="5_k24pf"]
[ext_resource type="AudioStream" uid="uid://ce756abk3ipcs" path="res://Audio/ssa.mp3" id="6_a7pbh"]
[ext_resource type="AudioStream" uid="uid://ci12pk15nudvu" path="res://Audio/vcxvxcdv.mp3" id="7_ye0jt"]
[ext_resource type="PackedScene" uid="uid://bdrkqejd8htea" path="res://scenes/EncounterView.tscn" id="8_cfq0f"]
[ext_resource type="PackedScene" uid="uid://c6yeey4j3upm4" path="res://scenes/inventory.tscn" id="8_pd1er"]
[ext_resource type="PackedScene" uid="uid://xqt4l46rhnwy" path="res://scenes/RumorView.tscn" id="8_x537r"]
[ext_resource type="PackedScene" uid="uid://bovy050xv5534" path="res://scenes/UI/time_panel.tscn" id="10_xnxdc"]
[ext_resource type="Script" uid="uid://0n132a882k4r" path="res://scripts/NotificationManager.cs" id="11_o3jky"]
[ext_resource type="PackedScene" uid="uid://c1jvgnt81ughl" path="res://scenes/notification.tscn" id="12_kp0ql"]
[ext_resource type="PackedScene" uid="uid://ce3r73hprtho" path="res://scenes/UI/stats_view.tscn" id="12_xnxdc"]
[ext_resource type="Script" uid="uid://bod5bn1der1x6" path="res://scenes/UIController.cs" id="13_mkg2b"]
[ext_resource type="Script" uid="uid://6mnsy7hidovy" path="res://scripts/StoryTeller.cs" id="15_0cxu4"]
[ext_resource type="PackedScene" uid="uid://fhoh6fiq15ei" path="res://scenes/encounters/bandits.tscn" id="16_0ehpd"]
[ext_resource type="PackedScene" uid="uid://b25d8ekeapuhi" path="res://scenes/encounters/storm_area.tscn" id="17_8wjpf"]

[node name="Root" type="Node3D"]
script = ExtResource("1_08o8g")

[node name="Player" parent="." node_paths=PackedStringArray("waypoints", "UI", "rumorView", "encounterView", "notificationManager") instance=ExtResource("2_25dfr")]
waypoints = NodePath("../Waypoints")
UI = NodePath("../CanvasLayer")
travelPlaylist = Array[AudioStream]([ExtResource("3_2phbr"), ExtResource("4_mkg2b"), ExtResource("5_1ns3k"), ExtResource("6_a7pbh"), ExtResource("7_ye0jt")])
rumorView = NodePath("../CanvasLayer/RumorView")
encounterView = NodePath("../CanvasLayer/EncounterView")
notificationManager = NodePath("../CanvasLayer/NotificationManager")

[node name="Waypoints" parent="." instance=ExtResource("5_k24pf")]

[node name="StoryTeller" type="Node3D" parent="."]
process_mode = 4
visible = false
script = ExtResource("15_0cxu4")
bandit_encounter = ExtResource("16_0ehpd")
storm_encounter = ExtResource("17_8wjpf")

[node name="WorldMap" parent="." instance=ExtResource("1_5opw3")]

[node name="CanvasLayer" type="CanvasLayer" parent="." node_paths=PackedStringArray("townPanel", "timeControlPanel", "inventoryUI", "tradeUI")]
script = ExtResource("13_mkg2b")
townPanel = NodePath("HSplitContainer/TownPanel")
timeControlPanel = NodePath("HSplitContainer/HUD/TimePanel")
inventoryUI = NodePath("HSplitContainer/HUD/Inventory")
tradeUI = NodePath("HSplitContainer/HUD/TradePanel")

[node name="HSplitContainer" type="HSplitContainer" parent="CanvasLayer"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
split_offset = 255

[node name="TownPanel" parent="CanvasLayer/HSplitContainer" instance=ExtResource("3_y7ipx")]
visible = false
layout_mode = 2

[node name="HUD" type="Control" parent="CanvasLayer/HSplitContainer"]
layout_mode = 2
mouse_filter = 2

[node name="TradePanel" parent="CanvasLayer/HSplitContainer/HUD" instance=ExtResource("4_5hv5t")]
visible = false
layout_mode = 1
offset_left = 87.0
offset_top = 116.0
offset_right = -161.0
offset_bottom = -168.0

[node name="TimePanel" parent="CanvasLayer/HSplitContainer/HUD" node_paths=PackedStringArray("world") instance=ExtResource("10_xnxdc")]
layout_mode = 1
offset_left = -233.0
offset_top = -92.0
offset_right = -25.0
offset_bottom = -25.0
world = NodePath("../../../../WorldMap")

[node name="Inventory" parent="CanvasLayer/HSplitContainer/HUD" instance=ExtResource("8_pd1er")]
layout_mode = 0
anchors_preset = 0
anchor_left = 0.0
anchor_top = 0.0
anchor_right = 0.0
anchor_bottom = 0.0
offset_left = 0.0
offset_top = 0.0
offset_right = 449.0
offset_bottom = 382.0
grow_horizontal = 1
grow_vertical = 1

[node name="StatsView" parent="CanvasLayer/HSplitContainer/HUD" instance=ExtResource("12_xnxdc")]
layout_mode = 0

[node name="EncounterView" parent="CanvasLayer" instance=ExtResource("8_cfq0f")]
visible = false

[node name="RumorView" parent="CanvasLayer" instance=ExtResource("8_x537r")]
visible = false
offset_left = 553.0
offset_top = 356.0
offset_right = 553.0
offset_bottom = 356.0

[node name="NotificationManager" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 1
anchor_left = 1.0
anchor_right = 1.0
offset_left = -184.0
offset_top = 26.0
offset_right = -144.0
offset_bottom = 66.0
grow_horizontal = 0
script = ExtResource("11_o3jky")
notification_scene = ExtResource("12_kp0ql")

[connection signal="mouse_entered" from="CanvasLayer/HSplitContainer/TownPanel" to="Waypoints" method="OnMouseExited"]
[connection signal="pressed" from="CanvasLayer/HSplitContainer/TownPanel/VBoxContainer/trade" to="CanvasLayer" method="OpenTrade"]
[connection signal="pressed" from="CanvasLayer/HSplitContainer/TownPanel/VBoxContainer/plot" to="Player" method="plotJourney"]
[connection signal="pressed" from="CanvasLayer/HSplitContainer/TownPanel/VBoxContainer/embark" to="Player" method="embark"]
[connection signal="pressed" from="CanvasLayer/HSplitContainer/TownPanel/VBoxContainer/cancel" to="Player" method="cancelPlot"]

[editable path="CanvasLayer/HSplitContainer/TownPanel"]
